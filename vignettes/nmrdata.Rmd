---
title: "nmrdata: Example 1D Proton NMR Data"
author: "Torben Kimhofer"
date: "`r Sys.Date()`"
output: BiocStyle::html_document
vignette: >
  %\VignetteIndexEntry{Introduction to the nmrdata package}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
bibliography: references.bib
---

# Introduction

The **nmrdata** package provides example 1D proton NMR spectra of murine 
urine samples collected before and after Roux-en-Y gastric bypass.
A sham surgery group is also included as a negative control [@li2011gut].

In addition to the processed dataset (`bariatric`), the package also contains a 
minimal set  of 21 raw Bruker NMR experiment folders, located 
under `inst/extdata/`.  These files can be accessed using the `system.file()` 
function, e.g.:

```{r}
# Bruker Topspin-processed spectral data for experiment folder 1
raw_path <- system.file("extdata", "1/pdata/1", package = "nmrdata")
```

Both, processed data and raw experiment files are primarily intended for 
demonstrating functionality of the  companion software package `metabom8`.

# Dataset description

- One-dimensional proton (\(^1\)H) NMR spectra  
- 67 urine samples (murine model)  
- Acquired on a Bruker Avance III 600 MHz spectrometer  
- Preprocessed with Probabilistic Quotient Normalization (PQN)  

The dataset is provided as an R list with three elements:

- `X.pqn`: Matrix of pre-processed spectra  
- `ppm`: Chemical shift vector (ppm)  
- `an`: Sample annotation data (e.g., class membership)
- `meta`: Acquisition and processing status parameters (Topspin), 
  prefixed with `a` and `p`, respectively

# Usage

```{r, eval=FALSE}
# TODO: Once ExhHub is assigned, rm eval=F in code chunk pars
library(nmrdata)

# load pre-processed data set
bariatric <- BariatricData()

# inspect structure
str(bariatric)

X.bariatric <- bariatric$X.pqn
ppm.bariatric <- bariatric$ppm

# plot first spectrum
plot(ppm.bariatric, X.bariatric[1,], type = "l",
     xlab = "Chemical shift (ppm)", ylab = "Intensity")

```


```{r, eval = requireNamespace("metabom8", quietly = TRUE), eval=FALSE}
library(metabom8)
library(ExperimentHub)

# TODO: Replace EHxxxx once assigned, rm eval=F in code chunk pars
raw_dir <- ExperimentHub()[["EHxxxx"]]  
list.files(raw_dir)

# import Bruker experiment files
read1d_proc(raw_dir, exp_type=list(pulprog='noesypr1d'))

# plot spectrum
spec(X[1,], ppm)

# For further examples and advanced workflows, see the metabom8 package.
```


# Package Version
```{r}
packageVersion("nmrdata")
```



# Session Info

```{r}
sessionInfo()
```


